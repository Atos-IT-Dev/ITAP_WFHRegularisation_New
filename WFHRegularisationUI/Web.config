<?xml version="1.0"?>

<configuration>
	<configSections>
		<section name="microsoft.identityModel"
					type="Microsoft.IdentityModel.Configuration.MicrosoftIdentityModelSection, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
	</configSections>

	<location path="FederationMetadata">
		<system.web>
			<authorization>
				<allow users="*"/>
			</authorization>
		</system.web>
	</location>

	<connectionStrings>
		<!--<add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient" />-->
		<add name="ApplicationServices" connectionString="Data Source=(LocalDb)\v11.0;Initial Catalog=aspnetdb.mdf;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient"/>
	</connectionStrings>

	<appSettings>
		<add key="DBMasterBETI" value="MASTERBETI"/>
		<add key="MasterBETISQLcon" value="server=172.16.33.233;Database=MasterBETI;User id=ITAPADMIN;Password=!t4p#2020" />
		<add key="SQLcon" value="server=172.16.33.233;Database=BETI;User id=ITAPADMIN;Password=!t4p#2020" />
		<add key="CONFILE" value="C:\WINDOWS\beti_config.xml"/>
		<add key="APP_ID" value="WFHREG"/>
		<add key="TECH" value=".NET"/>
		<add key="ENV" value="PRODUCTION"/>
		<add key="DB" value="MASTERBETI"/>
		<add key="LoginDasSessionKey" value="DASID"/>
		<add key="DASID" value="DASID"/>
		<add key="NAME" value="NAME"/>
		<add key="UseSwitch" value="0"/>
		<add key="Provider" value="WFHREG"></add>
		<add key="SignoutURL" value="https://itap-stg.myatos.net/sso/SignOut.aspx?wa=wsignout1.0&amp;wreply=http%3a%2f%2flocalhost:55457/AddTimeInTimeOut.aspx" />
		<!--<add key="SignoutURL" value="https://itap-stg.myatos.net/sso/SignOut.aspx?wa=wsignout1.0&amp;wreply=http%3a%2f%2flocalhost:58119/AddTimeInTimeOut.aspx" />-->
		<add key="FederationMetadataLocation" value="https://itap-stg.myatos.net/sso/FederationMetadata/2007-06/FederationMetadata.ashx" />
		<add key="SSOCertName" value="CN=ITAP_AUTH"/>
		<add key="AuthenticationMode" value="S"/>
		<add key="MainPageURL" value="%2fAddTimeInTimeOut.aspx"/>
		<add key="PageAccessibleTo" value="A875597,A205137,A505675"/>
		<add key="NotAuthorisedToAccessThisPage" value="You are not authorised to access this page."/>
		<!-- Added by Shardul S. Mahajan on 27-Feb-2023 starts here. -->
		<add key="AllowedEntities" value="0924,0328,0B57,0115"/>
		<!-- Added by Shardul S. Mahajan on 27-Feb-2023 ends here. -->
		<!-- Added by Shardul S. Mahajan on 01-Sep-2023 starts here. -->
		<add key="CommandTimeOutValue" value="43200"/>
		<!-- Added by Shardul S. Mahajan on 01-Sep-2023 ends here. -->
		<!-- Added by Shardul S. Mahajan on 02-Apr-2024 starts here. -->
		<add key="BenchShiftEmployeesMessage" value="Virtual In/Out time is disabled as you are assigned to Bench General Shift. Please contact your Line / Shift Manager for more details."/>
		<!-- Added by Shardul S. Mahajan on 02-Apr-2024 ends here. -->
	</appSettings>

	<system.web>
		<pages controlRenderingCompatibilityVersion="4.5">
			<controls>
				<!--<add tagPrefix="ITAP" src="~/BetiCommonControls/BetiAlertMessages.ascx" tagName="AlertMessage" />-->
			</controls>
		</pages>

		<httpRuntime requestValidationType="SampleRequestValidator" executionTimeout="999999" maxRequestLength="2097151"/>
		<authentication mode="None">
			<!--timeout="10"
			<forms loginUrl="~/BETICommonControls/BETILogon.aspx" name="adAuthCookie" path="/" protection="All"/>-->
		</authentication>

		<authorization>
			<deny users="?"/>
		</authorization>

		<httpModules>
			<add name="WSFederationAuthenticationModule"
				  type="CustomWsFederationAuthHandler.CustomWsFederationAuthModule"/>
			<add name="SessionAuthenticationModule"
				  type="Microsoft.IdentityModel.Web.SessionAuthenticationModule, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
		</httpModules>

		<compilation debug="true"
						 targetFramework="4.0">
			<assemblies>
				<add assembly="Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
			</assemblies>
		</compilation>

		<membership>
			<providers>
				<clear/>
				<add name="AspNetSqlMembershipProvider"
					  type="System.Web.Security.SqlMembershipProvider"
					  connectionStringName="ApplicationServices"
					  enablePasswordRetrieval="false"
					  enablePasswordReset="true"
					  requiresQuestionAndAnswer="false"
					  requiresUniqueEmail="false"
					  maxInvalidPasswordAttempts="5"
					  minRequiredPasswordLength="6"
					  minRequiredNonalphanumericCharacters="0"
					  passwordAttemptWindow="10"
					  applicationName="/" />
			</providers>
		</membership>

		<profile>
			<providers>
				<clear/>
				<add name="AspNetSqlProfileProvider"
					  type="System.Web.Profile.SqlProfileProvider"
					  connectionStringName="ApplicationServices"
					  applicationName="/"/>
			</providers>
		</profile>

		<roleManager enabled="false">
			<providers>
				<clear/>
				<add name="AspNetSqlRoleProvider"
					  type="System.Web.Security.SqlRoleProvider"
					  connectionStringName="ApplicationServices"
					  applicationName="/" />
				<add name="AspNetWindowsTokenRoleProvider"
					  type="System.Web.Security.WindowsTokenRoleProvider"
					  applicationName="/" />
			</providers>
		</roleManager>

	</system.web>

	<system.webServer>
		<validation validateIntegratedModeConfiguration="false"/>
		<modules runAllManagedModulesForAllRequests="true">
			<add name="WSFederationAuthenticationModule"
				  type="CustomWsFederationAuthHandler.CustomWsFederationAuthModule"/>
			<add name="SessionAuthenticationModule"
				  type="Microsoft.IdentityModel.Web.SessionAuthenticationModule, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
				  preCondition="managedHandler"/>
		</modules>

		<httpProtocol>
			<customHeaders>
				<add name="Content-Security-Policy" value="upgrade-insecure-requests" />
			</customHeaders>
		</httpProtocol>
	</system.webServer>

	<microsoft.identityModel>
		<service>
			<securityTokenHandlers>
				<!-- Replace the SessionSecurityTokenHandler with our own. -->
				<remove type="Microsoft.IdentityModel.Tokens.SessionSecurityTokenHandler, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
				<add type="RsaEncryptedSessionSecurityTokenHandler" />
			</securityTokenHandlers>
			<audienceUris>
				<add value="http://localhost:55457/AddTimeInTimeOut.aspx"/>
				<!--<add value="http://localhost:58119/AddTimeInTimeOut.aspx"/>-->
			</audienceUris>
			<federatedAuthentication>
				<wsFederation passiveRedirectEnabled="true"
								  issuer="https://itap-stg.myatos.net/sso/Default.aspx"
								  realm="http://localhost:55457/AddTimeInTimeOut.aspx"
								  requireHttps="false"/>
				<cookieHandler requireSsl="false"/>
			</federatedAuthentication>
			<applicationService>
				<claimTypeRequired>
					<claimType type="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"
								  optional="true"/>
					<claimType type="http://schemas.microsoft.com/ws/2008/06/identity/claims/role"
								  optional="true"/>
				</claimTypeRequired>
			</applicationService>
			<issuerNameRegistry type="Microsoft.IdentityModel.Tokens.ConfigurationBasedIssuerNameRegistry, Microsoft.IdentityModel, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35">
				<trustedIssuers>
					<add thumbprint="a58d6da3516dbe5164b95808897d9e8c6205cdbe" name="https://itap.myatos.net/sso/default.aspx" />
				</trustedIssuers>
			</issuerNameRegistry>
		</service>
	</microsoft.identityModel>
</configuration>
